---
title: "cake_data_analysis"
author: "VM"
date: "09/11/2020"
output: html_document
---
#Read data first and load libraries

```{r}
library(tidyverse)
library(janitor)
clean_data <- read_csv("~/dirty_data_project/task2/clean_data/clean_cake_data.csv")
wide_data <- read_csv("~/dirty_data_project/task2/clean_wide_cake_data.csv")
```
```{r}
head(clean_data)
head(wide_data)
```
## There are a lot of NA as these ingredient were not used in cake, therefore, 
they were left and further ignored in analysis.

###Which cake has the most cocoa in it?

```{r}
clean_data %>% 
  filter(ingredient == "cocoa") %>% 
  remove_empty("cols") 
  
wide_data %>% 
  select(cakes, cocoa_tablespoon) %>% 
  drop_na(cocoa_tablespoon) %>% 
  arrange(desc(cocoa_tablespoon)) %>% 
  head(1)
  
```
###For sponge cake, how many cups of ingredients are used in total?
```{r}
clean_data %>% 
  select(measure, ingredient, sponge) %>% 
  filter(measure == "cup") %>% 
  drop_na() %>% 
  count()

wide_data %>% 
  filter(cakes == "sponge") %>% 
  remove_empty("cols") %>% 
  select(matches("cup$")) %>% 
  ncol()
```
###How many ingredients are measured in teaspoons?
```{r}
clean_data %>% 
  filter(measure == "teaspoon") %>% 
  n_distinct()

wide_data %>% 
  select(matches("teaspoon")) %>% 
  ncol()
```
###Which cake has the most unique ingredients?
```{r}
clean_data %>% 
  select(-1:-3) %>% 
  summarise_all(funs(n_distinct)) %>% 
  which.max()
  
wide_data %>% 
  mutate(total = count(unique(`almond essence_teaspoon`)))
```

###Which ingredients are used only once?

```{r}
clean_data %>% 
  select(-1, -3)  %>% 
  group_by(ingredient) 

wide_data %>% 
```







